USE [IARCOD]
GO

/****** Object: View [dbo].[DataValuesAggregate] Script Date: 02/07/2014 09:54:31 ******/
SET ANSI_NULLS ON
GO

SET QUOTED_IDENTIFIER ON
GO






CREATE view [dbo].[DataValuesAggregate] AS
SELECT DatastreamID, OffsetValue, OffsetTypeID,CONVERT(varchar(100), MIN(LocalDateTime), 120) AS BeginDateTime, CONVERT(varchar(100), MAX(LocalDateTime), 120) AS EndDateTime,
               CONVERT(varchar(100), DATEADD(Hour, -UTCOffset, MIN(LocalDateTime)), 120) AS BeginDateTimeUTC, CONVERT(varchar(100), DATEADD(Hour, -UTCOffset,
               MAX(LocalDateTime)), 120) AS EndDateTimeUTC, COUNT(*) AS TotalValues
FROM dbo.DataValues
GROUP BY DatastreamID,offsetvalue, offsettypeid,UTCOffset;




GO